问题一：mysql忘记登记密码如何解决?

1，运行mysql命令窗口。
2，执行命令 :
mysql> use mysql;
Database changed
mysql> update user set password=password('123') where user='root'
    -> ;
Query OK, 1 row affected (0.19 sec)
Rows matched: 1  Changed: 1  Warnings: 0
mysql>

问题2：Mysql中如何对数据进行排名

1,第一种,分数相同,排名一样。
DELIMITER $$
USE `dzjc_zhejiang`$$
DROP PROCEDURE IF EXISTS `P_SCORE_MAIN`$$
CREATE DEFINER = `root` @`localhost` PROCEDURE `P_SCORE_MAIN` (
  IN p_Year INTEGER,
  IN p_Month INTEGER,
  IN p_Xzqhid VARCHAR (50)
) 
BEGIN
  DECLARE m_total NUMERIC ;
  DECLARE iCount NUMERIC ;
  DECLARE kfScore NUMERIC (10, 4) ;
  -- 扣分表分数汇总
  DECLARE m_max_coefficient DATE ;
  DECLARE m_year_month VARCHAR (20) ;
  -- 考核年,月
  DECLARE m_year VARCHAR (20) ;
  -- 考核年
  DECLARE m_month VARCHAR (20) ;
  -- 考核月
  DECLARE m_sxlrl VARCHAR (20) ;
  -- 事项纳入率分数
  DECLARE m_spsxfs VARCHAR (20) ;
  -- 审批时效分数
  DECLARE m_sjdf VARCHAR (20) ;
  -- 实际得分
  DECLARE v_xzqhid VARCHAR (20) ;
  DECLARE v_bmid VARCHAR (100) ;
  DECLARE v_nf VARCHAR (4) ;
  DECLARE v_yf VARCHAR (2) ;
  DECLARE b INT DEFAULT 0 ;
  DECLARE rank INT DEFAULT 0;
  DECLARE cur_1 CURSOR FOR 
  SELECT 
    xzqhid,
    bmid,
    nf,
    yf,
    lrldf,
    spsxdf,
    sjdf,
    CASE
      WHEN @prevRank = sjdf 
      THEN @curRank 
      WHEN @prevRank := sjdf 
      THEN @curRank := @curRank + 1 
    END AS rank 
  FROM
    (SELECT 
      xzqhid,
      bmid,
      nf,
      yf,
      lrldf,
      spsxdf,
      lrldf + spsxdf sjdf 
    FROM
      (SELECT 
        kf.xzqhid,
        kf.bmid,
        kf.nf,
        kf.yf,
        SUM(
          CASE
            kf.kf_type 
            WHEN '0' 
            THEN kf.sjdf 
          END
        ) lrldf,
        CASE
          WHEN SUM(
            CASE
              kf.kf_type 
              WHEN '1' 
              THEN kf.sjdf 
            END
          ) <= 15 
          THEN 15 
          ELSE SUM(
            CASE
              kf.kf_type -- 审批时效分数  对少于15分的,保底分就是15分
              WHEN '1' 
              THEN kf.sjdf 
            END
          ) 
        END spsxdf 
      FROM
        t_jc_jxkfb kf 
      WHERE KF.NF = p_Year 
        AND KF.YF = p_Month 
      GROUP BY kf.xzqhid,
        kf.bmid,
        kf.nf,
        kf.yf) t 
    ORDER BY sjdf DESC) t,
    (SELECT 
      @curRank := 0,
      @prevRank := NULL) r 
  ORDER BY sjdf DECLARE CONTINUE HANDLER FOR NOT FOUND SET b = 1 ;
  IF p_Month < 10 
  THEN SET m_year_month = CONCAT(p_Year, '0', p_Month) ;
  ELSE SET m_year_month = CONCAT(p_Year, p_Month) ;
  -- 获取考核年月份
  END IF ;
  SET m_year = p_Year ;
  SET m_month = p_Month ;
  IF p_Month < 10 
  THEN SET m_month = CONCAT('0', p_Month) ;
  END IF ;
  -- 清楚计算结果表
  DELETE 
  FROM
    t_jc_jxcpjgb 
  WHERE nf = p_Year 
    AND yf = p_Month 
    AND region_id = p_Xzqhid ;
  OPEN cur_1 ;
  FETCH cur_1 INTO v_xzqhid,
  v_bmid,
  v_nf,
  v_yf,
  m_sxlrl,
  m_spsxfs,
  m_sjdf ;
  WHILE
    b <> 1 DO 
    INSERT INTO t_jc_jxcpjgb (
      id,
      departid,
      nf,
      yf,
      zf,
      region_id,
      sxlrzf,
      spsxzf,
      zfmc
    ) 
    VALUES
      (
        UUID(),
        v_bmid,
        v_nf,
        v_yf,
        m_sjdf,
        v_xzqhid,
        m_sxlrl,
        m_spsxfs,
        rank
      ) ;
    FETCH cur_1 INTO v_xzqhid,
    v_bmid,
    v_nf,
    v_yf,
    m_sxlrl,
    m_spsxfs,
    m_sjdf ;
  END WHILE ;
  CLOSE cur_1 ;
END $$
DELIMITER ;

问题3：在mysql中常用的函数
date_format(date,'%y-%m-%d')  ------->oracle中的to_char()函数    date_format(sysdate(), '%y-%m-%d')  等价于   
to_char(sysdate,'yyyy-mm-dd')
str_to_date(date,'%y-%m-%d')   -------->oracle中的to_date()函数
ifnull(busiid,0)  ------>>>oracle中的nvl()函数,当值为null的时候替换为指定值。
concat(y.year ,y.month )  ---->>>>oracle 中的 || 字符串连接
sysdate()  ------->>>>oracle中的sysdate
substr()  -----oracle 中的 substr()函数 下表从1开始,截取四位   substr(busiid,1,4)
DATE_FORMAT(NOW(),'%Y%m%d')   ---存储过程里面取系统时间
select cast(11 as unsigned int) /*整型*/    -----mysql      to_number()
select cast(11 as decimal(10,2)) /*浮点型*/ -----mysql      to_number()
date_format(s.id.beginTime,'%Y-%m-%d %H:%i:%s')   格式
FORMAT(sjdf,2);   ---保留两位小数

问题4：mysql锁表与解锁
show processlist;
找到锁进程，kill id ;

问题4：Xbrige工具从oracle桥接到mysql解决办法。
1，Parameter of prepared statement which is set through mysql_send_long_data() is longer than 'max_allowed_packet' bytes    。。
解决办法：修改 my.ini文件。max_allowed_packet = 1024M
2,incorrect string value: '\xEE\x81\x92\xE8\x90\xB1...' for column 'REGISTER_NAME' at row 1
解决办法：character-set-server=utf8mb4
命令：alter table TABLE_NAME convert to character set utf8mb4 collate utf8mb4_bin; （将TABLE_NAME替换成你的表名）
问题3：MySQL: Error Code: 1118 Row size too large (> 8126). Changing some columns to TEXT or BLOB
解决办法：
修改 my.ini文件
innodb_file_format=Barracuda
innodb_file_format_check = ON
innodb_log_file_size = 500M
innodb_log_buffer_size = 80

问题4:mysql非分区表转分区表。

第一步：创建分区表
CREATE TABLE `t_engine_compute_data_optimize_bak` (
  `ID` TEXT,
  `BUSIID` VARCHAR(80) DEFAULT NULL,
  `ORIGCODE` VARCHAR(80) DEFAULT NULL,
  `BUSITYPE` VARCHAR(10) DEFAULT NULL,
  `ORGID` VARCHAR(60) DEFAULT NULL,
  `PERM_ID` VARCHAR(100) DEFAULT NULL,
  `ITEMNAME` TEXT,
  `PROJECTNAME` TEXT,
  `UNITTYPE` VARCHAR(10) DEFAULT NULL,
  `LIMITS` DECIMAL(4,0) DEFAULT NULL,
  `TIMEUNIT` VARCHAR(2) DEFAULT NULL,
  `BEGINSTEP_CODE` VARCHAR(100) DEFAULT NULL,
  `BEGINTIME` DATETIME DEFAULT NULL,
  `ENDSTEP_CODE` VARCHAR(100) DEFAULT NULL,
  `ENDTIME` DATETIME DEFAULT NULL,
  `ISCROSSED` VARCHAR(2) DEFAULT NULL,
  `ITEMBUSITYPE` VARCHAR(2) DEFAULT NULL,
  `ISEND` VARCHAR(2) DEFAULT NULL,
  `COMPANYNAME` TEXT,
  `CURRENTSTEP_CODE` VARCHAR(100) DEFAULT NULL,
  `COMMITMENT` BIGINT(22) DEFAULT NULL,
  `LIMITDAYS` BIGINT(22) DEFAULT NULL,
  `COMMITMETTIMEDESC` VARCHAR(200) DEFAULT NULL,
  `BEGINTIMENAME` VARCHAR(100) DEFAULT NULL,
  `ENDTIMENAME` VARCHAR(100) DEFAULT NULL,
  `LAWENDDATE` DATETIME DEFAULT NULL,
  `APPROVE_TYPE` VARCHAR(20) DEFAULT NULL,
  `ISMULTI` VARCHAR(100) DEFAULT NULL,
  `MULTI_ID` VARCHAR(100) DEFAULT NULL,
  `REGION_ID` VARCHAR(40) DEFAULT NULL,
  `APPLICANTNAME` VARCHAR(200) DEFAULT NULL,
  `APPLICANTOPERATOR` VARCHAR(50) DEFAULT NULL,
  `APPLICANTPHONE` VARCHAR(20) DEFAULT NULL,
  `APPLICANTMOBILE` VARCHAR(20) DEFAULT NULL,
  `APPLICANTEMAIL` VARCHAR(50) DEFAULT NULL,
  `APPLICANTTYPE` VARCHAR(50) DEFAULT NULL,
  `CERTIFICATETYPE` VARCHAR(10) DEFAULT NULL,
  `CERTIFICATECODE` VARCHAR(200) DEFAULT NULL,
  `STATIS_YEAR` VARCHAR(4) DEFAULT NULL,
  `STATIS_MONTH` VARCHAR(2) DEFAULT NULL,
  `COMPLETIONNAME` VARCHAR(80) DEFAULT NULL,
  `COMPLETIONRESULT` VARCHAR(80) DEFAULT NULL,
  `COMPLETIONDESC` TEXT,
  `OBSOLETEREASON` VARCHAR(200) DEFAULT NULL,
  `CERTIFICATENAME` VARCHAR(200) DEFAULT NULL,
  `CERTIFICATEPERIOD` VARCHAR(30) DEFAULT NULL,
  `CERTIFICATEORG` VARCHAR(200) DEFAULT NULL,
  `CHARGEAMOUNT` DECIMAL(9,2) DEFAULT NULL,
  `CHARGEUNIT` VARCHAR(20) DEFAULT NULL,
  `CURRENTSTATUS` DECIMAL(2,0) DEFAULT NULL,
  `CURSTATUSTIME` DATETIME DEFAULT NULL,
  `DESCRIPTION` VARCHAR(200) DEFAULT NULL,
  `SPECIALLIMIT` DECIMAL(3,0) DEFAULT NULL,
  `SPECIALUNIT` VARCHAR(10) DEFAULT NULL,
  `SPECIALSTARTDATE` DATETIME DEFAULT NULL,
  `SPECIALENDDATE` DATETIME DEFAULT NULL,
  `SPECIALRESULT` VARCHAR(200) DEFAULT NULL,
  `CREATEDATE` DATETIME DEFAULT NULL,
  `CONFIRMDATE` DATETIME DEFAULT NULL,
  `CONFIRM` DECIMAL(1,0) DEFAULT NULL,
  `CONFIRMSTATUS` VARCHAR(20) DEFAULT NULL,
  `ENGINENODE_ID` VARCHAR(20) DEFAULT NULL,
  `COMPUTERULEID` VARCHAR(80) DEFAULT NULL,
  `EXPSCANFLAG` VARCHAR(20) DEFAULT NULL,
  `TIMESCANFLAG` VARCHAR(20) DEFAULT NULL,
  `ADVISETIME` DATETIME DEFAULT NULL,
  `ADVISEACCEPTTIME` DATETIME DEFAULT NULL,
  `ACCEPTANCETIME` DATETIME DEFAULT NULL,
  `DATAEXCHANGE` VARCHAR(10) DEFAULT NULL,
  `ITEMVERSION` BIGINT(22) DEFAULT NULL,
  `YWBLREMAINDAYS` VARCHAR(200) DEFAULT NULL,
  `SOURCEID` VARCHAR(200) DEFAULT NULL,
  `COMMITMENTTIMEDESC` VARCHAR(200) DEFAULT NULL,
  `COSTTIMEDESC` VARCHAR(200) DEFAULT NULL,
  `COMPUTE_BEGINETIME` DATETIME DEFAULT NULL,
  `COMPUTE_BEGINENAME` VARCHAR(200) DEFAULT NULL,
  `COMPUTE_ENDTIME` DATETIME DEFAULT NULL,
  `COMPUTE_ENDTIMENAME` VARCHAR(200) DEFAULT NULL,
  `COMPUTE_SCANFLAG` VARCHAR(10) DEFAULT NULL,
  `RESULTVALUE` VARCHAR(100) DEFAULT NULL,
  `RESULT` TEXT,
  `RULEDESC` TEXT,
  `TYPE` VARCHAR(20) DEFAULT NULL,
  `ISDELAY` VARCHAR(10) DEFAULT NULL,
  `HASSPECIALAPPLY` VARCHAR(10) DEFAULT NULL,
  `ISIMMEDIATELY` VARCHAR(10) DEFAULT NULL,
  `TABLENAME` VARCHAR(80) DEFAULT NULL,
  `RULEID` VARCHAR(100) DEFAULT NULL,
  `CURMAXSTATUS` VARCHAR(100) DEFAULT NULL,
  `CURMAXSTATUSNAME` VARCHAR(100) DEFAULT NULL,
  KEY `T_ENGINE_COMPUTE_DATA_OPTIMIZE` (`BUSIID`),
  KEY `ruleid` (`RULEID`)
) ENGINE=INNODB DEFAULT CHARSET=gbk
PARTITION BY RANGE (TO_DAYS(BEGINTIME))
(PARTITION PMIN VALUES LESS THAN (735599) ENGINE = INNODB,
 PARTITION P201401 VALUES LESS THAN (735630) ENGINE = INNODB,
 PARTITION P201402 VALUES LESS THAN (735658) ENGINE = INNODB,
 PARTITION P201403 VALUES LESS THAN (735689) ENGINE = INNODB,
 PARTITION P201404 VALUES LESS THAN (735719) ENGINE = INNODB,
 PARTITION P201405 VALUES LESS THAN (735750) ENGINE = INNODB,
 PARTITION P201406 VALUES LESS THAN (735781) ENGINE = INNODB,
 PARTITION P201407 VALUES LESS THAN (735811) ENGINE = INNODB,
 PARTITION P201408 VALUES LESS THAN (735842) ENGINE = INNODB,
 PARTITION P201409 VALUES LESS THAN (735872) ENGINE = INNODB,
 PARTITION P201410 VALUES LESS THAN (735903) ENGINE = INNODB,
 PARTITION P201411 VALUES LESS THAN (735933) ENGINE = INNODB,
 PARTITION P201412 VALUES LESS THAN (735964) ENGINE = INNODB,
 PARTITION P201501 VALUES LESS THAN (735995) ENGINE = INNODB,
 PARTITION P201502 VALUES LESS THAN (736023) ENGINE = INNODB,
 PARTITION P201503 VALUES LESS THAN (736054) ENGINE = INNODB,
 PARTITION P201504 VALUES LESS THAN (736084) ENGINE = INNODB,
 PARTITION P201505 VALUES LESS THAN (736115) ENGINE = INNODB,
 PARTITION P201506 VALUES LESS THAN (736146) ENGINE = INNODB,
 PARTITION P201507 VALUES LESS THAN (736176) ENGINE = INNODB,
 PARTITION P201508 VALUES LESS THAN (736207) ENGINE = INNODB,
 PARTITION P201509 VALUES LESS THAN (736237) ENGINE = INNODB,
 PARTITION P201510 VALUES LESS THAN (736268) ENGINE = INNODB,
 PARTITION P201511 VALUES LESS THAN (736298) ENGINE = INNODB,
 PARTITION P201512 VALUES LESS THAN (736329) ENGINE = INNODB,
 PARTITION P201601 VALUES LESS THAN (736360) ENGINE = INNODB,
 PARTITION P201602 VALUES LESS THAN (736389) ENGINE = INNODB,
 PARTITION P201603 VALUES LESS THAN (736420) ENGINE = INNODB,
 PARTITION P201604 VALUES LESS THAN (736450) ENGINE = INNODB,
 PARTITION P201605 VALUES LESS THAN (736481) ENGINE = INNODB,
 PARTITION P201606 VALUES LESS THAN (736512) ENGINE = INNODB,
 PARTITION P201607 VALUES LESS THAN (736542) ENGINE = INNODB,
 PARTITION P201608 VALUES LESS THAN (736573) ENGINE = INNODB,
 PARTITION P201609 VALUES LESS THAN (736603) ENGINE = INNODB,
 PARTITION P201610 VALUES LESS THAN (736634) ENGINE = INNODB,
 PARTITION P201611 VALUES LESS THAN (736664) ENGINE = INNODB,
 PARTITION P201612 VALUES LESS THAN (736695) ENGINE = INNODB,
 PARTITION P201701 VALUES LESS THAN (736726) ENGINE = INNODB,
 PARTITION P201702 VALUES LESS THAN (736754) ENGINE = INNODB,
 PARTITION P201703 VALUES LESS THAN (736785) ENGINE = INNODB,
 PARTITION P201704 VALUES LESS THAN (736815) ENGINE = INNODB,
 PARTITION P201705 VALUES LESS THAN (736846) ENGINE = INNODB,
 PARTITION P201706 VALUES LESS THAN (736876) ENGINE = INNODB,
 PARTITION P201707 VALUES LESS THAN (736907) ENGINE = INNODB,
 PARTITION P201708 VALUES LESS THAN (736938) ENGINE = INNODB,
 PARTITION P201709 VALUES LESS THAN (736968) ENGINE = INNODB,
 PARTITION P201710 VALUES LESS THAN (736999) ENGINE = INNODB,
 PARTITION P201711 VALUES LESS THAN (737029) ENGINE = INNODB,
 PARTITION P201712 VALUES LESS THAN (737060) ENGINE = INNODB,
 PARTITION P201801 VALUES LESS THAN (737091) ENGINE = INNODB,
 PARTITION P201802 VALUES LESS THAN (737119) ENGINE = INNODB,
 PARTITION P201803 VALUES LESS THAN (737150) ENGINE = INNODB,
 PARTITION P201804 VALUES LESS THAN (737180) ENGINE = INNODB,
 PARTITION P201805 VALUES LESS THAN (737211) ENGINE = INNODB,
 PARTITION P201806 VALUES LESS THAN (737241) ENGINE = INNODB,
 PARTITION P201807 VALUES LESS THAN (737272) ENGINE = INNODB,
 PARTITION P201808 VALUES LESS THAN (737303) ENGINE = INNODB,
 PARTITION P201809 VALUES LESS THAN (737333) ENGINE = INNODB,
 PARTITION P201810 VALUES LESS THAN (737364) ENGINE = INNODB,
 PARTITION P201811 VALUES LESS THAN (737394) ENGINE = INNODB,
 PARTITION P201812 VALUES LESS THAN (737425) ENGINE = INNODB,
 PARTITION P201901 VALUES LESS THAN (737456) ENGINE = INNODB,
 PARTITION P201902 VALUES LESS THAN (737484) ENGINE = INNODB,
 PARTITION P201903 VALUES LESS THAN (737515) ENGINE = INNODB,
 PARTITION P201904 VALUES LESS THAN (737545) ENGINE = INNODB,
 PARTITION P201905 VALUES LESS THAN (737576) ENGINE = INNODB,
 PARTITION P201906 VALUES LESS THAN (737606) ENGINE = INNODB,
 PARTITION P201907 VALUES LESS THAN (737637) ENGINE = INNODB,
 PARTITION P201908 VALUES LESS THAN (737668) ENGINE = INNODB,
 PARTITION P201909 VALUES LESS THAN (737698) ENGINE = INNODB,
 PARTITION P201910 VALUES LESS THAN (737729) ENGINE = INNODB,
 PARTITION P201911 VALUES LESS THAN (737759) ENGINE = INNODB,
 PARTITION P201912 VALUES LESS THAN (737790) ENGINE = INNODB,
 PARTITION PMAX VALUES LESS THAN MAXVALUE ENGINE = INNODB) 

第二步：
非分区表数据插入到分区表
INSERT INTO t_engine_compute_data_optimize_bak (SELECT * FROM t_engine_compute_data_optimize)

第三步：
删掉非分区表


第四步：重命名，将分区表命名为之前的非分区表
RENAME  TABLE t_engine_compute_data_optimize_bak TO t_engine_compute_data_optimize;  

第五步：定义Mysql触发器


第六步：
创建事件,定时调用存储过程
 CREATE EVENT if not exists e_test 
on schedule every 30 second 
on completion preserve 
do call test();  

第七步:mysql存储过程中定义事物
 DROP PROCEDURE IF EXISTS  test_sp1  
 CREATE PROCEDURE test_sp1( )  
 BEGIN  
  DECLARE t_error INTEGER DEFAULT 0;  
  DECLARE CONTINUE HANDLER FOR SQLEXCEPTION SET t_error=1;  
  START TRANSACTION;  
  INSERT INTO test VALUES(NULL, 'test sql 001');     
  INSERT INTO test VALUES('1', 'test sql 002');     
 IF t_error = 1 THEN
        ROLLBACK;  
  ELSE 
   COMMIT;  
 END IF;  
 END
